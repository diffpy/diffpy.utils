

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tools Example &mdash; diffpy.utils 3.7.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=276dbae9"></script>
      <script src="../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=cca77546"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Linear Absorption Coefficient (μ) Examples" href="mu_calc_examples.html" />
    <link rel="prev" title="Parsers Example" href="parsers_example.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            diffpy.utils
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utilities/utilities.html">Utilities</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="diffraction_objects_example.html">Diffraction Objects Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="transforms_example.html">Transforms Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="resample_example.html">Resampling Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="parsers_example.html">Parsers Example</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Tools Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="mu_calc_examples.html">Linear Absorption Coefficient (μ) Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/diffpy.utils.html">Package API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">diffpy.utils</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="examples.html">Examples</a></li>
      <li class="breadcrumb-item active">Tools Example</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/diffpy/diffpy.utils/blob/main/docs/source/examples/tools_example.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="id1">
<h1>Tools Example<a class="headerlink" href="#id1" title="Link to this heading"></a></h1>
<p>The tools module contains various tools that may be useful when you manipulate and analyze diffraction data.</p>
<section id="automatically-capture-user-info">
<h2>Automatically Capture User Info<a class="headerlink" href="#automatically-capture-user-info" title="Link to this heading"></a></h2>
<p>One task we would like to do is to capture and propagate useful metadata that describes the diffraction data.
Some is essential such as wavelength and radiation type. Other metadata is useful such as information about the
sample, co-workers and so on.  However, one of the most important bits of information is the name of the data owner.
For example, in <code class="docutils literal notranslate"><span class="pre">DiffractionObjects</span></code> this is stored in the <code class="docutils literal notranslate"><span class="pre">metadata</span></code> dictionary as <code class="docutils literal notranslate"><span class="pre">owner_name</span></code>, <code class="docutils literal notranslate"><span class="pre">owner_email</span></code>,
and <code class="docutils literal notranslate"><span class="pre">owner_orcid</span></code>.</p>
<p>To reduce experimenter overhead when collecting this information, we have developed an infrastructure that helps
to capture this information automatically when you are using <code class="docutils literal notranslate"><span class="pre">DiffractionObjects</span></code> and other diffpy tools.
You may also reuse this infrastructure for your own projects using tools in this tutorial.</p>
<p>This example will demonstrate how <code class="docutils literal notranslate"><span class="pre">diffpy.utils</span></code> allows us to conveniently load and manage user and package information.
Using the tools module, we can efficiently get them in terms of a dictionary.</p>
<section id="load-user-info-into-your-program">
<h3>Load user info into your program<a class="headerlink" href="#load-user-info-into-your-program" title="Link to this heading"></a></h3>
<p>To use this functionality in your own code make use of the <code class="docutils literal notranslate"><span class="pre">get_user_info</span></code> function in
<code class="docutils literal notranslate"><span class="pre">diffpy.utils.tools</span></code> which will search for information about the user, parse it, and return
it in a dictionary object e.g. if the user is “Jane Doe” with email “<a class="reference external" href="mailto:janedoe&#37;&#52;&#48;gmail&#46;com">janedoe<span>&#64;</span>gmail<span>&#46;</span>com</a>” and ORCID
“0000-0000-0000-0000”, and if the
function can find the information (more on this below), if you type this</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">diffpy.utils.tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_user_info</span>
<span class="n">user_info</span> <span class="o">=</span> <span class="n">get_user_info</span><span class="p">()</span>
</pre></div>
</div>
<p>The function will return</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;owner_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Jane Doe&quot;</span><span class="p">,</span> <span class="s2">&quot;owner_email&quot;</span><span class="p">:</span> <span class="s2">&quot;janedoe@email.com&quot;</span><span class="p">,</span> <span class="s2">&quot;owner_orcid&quot;</span><span class="p">:</span> <span class="s2">&quot;0000-0000-0000-0000&quot;</span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="where-does-get-user-info-get-the-user-information-from">
<h3>Where does <code class="docutils literal notranslate"><span class="pre">get_user_info()</span></code> get the user information from?<a class="headerlink" href="#where-does-get-user-info-get-the-user-information-from" title="Link to this heading"></a></h3>
<p>The function will first attempt to load the information from configuration files with the name <code class="docutils literal notranslate"><span class="pre">diffpyconfig.json</span></code>
on your hard-drive.
It looks for files in the current working directory and in the computer-user’s home (i.e., login) directory.
For example, it might be in C:/Users/yourname`` or something like that, but to find this directory, open
a terminal and a unix or mac system type</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~</span>
<span class="n">pwd</span>
</pre></div>
</div>
<p>Or type <code class="docutils literal notranslate"><span class="pre">Echo</span> <span class="pre">$HOME</span></code>.  On a Windows computer</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="o">%</span><span class="n">USERPROFILE</span><span class="o">%</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>It is also possible to override the values in the config files at run-time by passing values directly into the
function according to <code class="docutils literal notranslate"><span class="pre">get_user_info</span></code>, for example,
<code class="docutils literal notranslate"><span class="pre">get_user_info(owner_name=&quot;Janet</span> <span class="pre">Doe&quot;,</span> <span class="pre">owner_email=&quot;janetdoe&#64;email.com&quot;,</span> <span class="pre">owner_orcid=&quot;1111-1111-1111-1111&quot;)</span></code>.
The information to pass into <code class="docutils literal notranslate"><span class="pre">get_user_info</span></code> could be entered by a user through a command-line interface
or into a gui.</p>
</section>
<section id="what-if-no-config-files-exist-yet">
<h3>What if no config files exist yet?<a class="headerlink" href="#what-if-no-config-files-exist-yet" title="Link to this heading"></a></h3>
<p>If no configuration files can be found, they can be created using a text editor, or by using a diffpy tool
called <code class="docutils literal notranslate"><span class="pre">check_and_build_global_config()</span></code> which, if no global config file can be found, prompts the user for the
information then writes the config file in the user’s home directory.</p>
<p>When building an application where you want to capture data-owner information, we recommend you execute
<code class="docutils literal notranslate"><span class="pre">check_and_build_global_config()</span></code> first followed by <code class="docutils literal notranslate"><span class="pre">get_user_info</span></code> in your app workflow.  E.g.,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">diffpy.utils.tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">check_and_build_global_config</span><span class="p">,</span> <span class="n">get_user_info</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="k">def</span><span class="w"> </span><span class="nf">my_cool_data_enhancer_app_main</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">filepath</span><span class="p">):</span>
    <span class="n">check_and_build_global_config</span><span class="p">()</span>
    <span class="n">metadata_enhanced_data</span> <span class="o">=</span> <span class="n">get_user_info</span><span class="p">()</span>
    <span class="n">metadata_enhanced_data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;creation_time&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span>
                                   <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">metadata_enhanced_data</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">check_and_build_global_config()</span></code> only
interrupts execution if it can’t find a valid config file, and so if the user enters valid information
it will only run once.  However, if you want to bypass this behavior,
<code class="docutils literal notranslate"><span class="pre">check_and_build_global_config()</span></code> takes an optional boolean <code class="docutils literal notranslate"><span class="pre">skip_config_creation</span></code> parameter that
could be set to <code class="docutils literal notranslate"><span class="pre">True</span></code> at runtime to override the config creation.</p>
</section>
<section id="what-happens-when-you-run-check-and-build-global-config">
<h3>What happens when you run <code class="docutils literal notranslate"><span class="pre">check_and_build_global_config()</span></code>?<a class="headerlink" href="#what-happens-when-you-run-check-and-build-global-config" title="Link to this heading"></a></h3>
<p>When you set <code class="docutils literal notranslate"><span class="pre">skip_config_creation</span></code> to <code class="docutils literal notranslate"><span class="pre">False</span></code> and there is no existing global configuration file,
the function will prompt you for inputs (name, email, ORCID).
An example of the prompts you may see is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Please</span> <span class="n">enter</span> <span class="n">the</span> <span class="n">name</span> <span class="n">you</span> <span class="n">would</span> <span class="n">want</span> <span class="n">future</span> <span class="n">work</span> <span class="n">to</span> <span class="n">be</span> <span class="n">credited</span> <span class="n">to</span><span class="p">:</span> <span class="n">Jane</span> <span class="n">Doe</span>
<span class="n">Please</span> <span class="n">enter</span> <span class="n">your</span> <span class="n">email</span><span class="p">:</span> <span class="n">janedoe</span><span class="nd">@example</span><span class="o">.</span><span class="n">com</span>
<span class="n">Please</span> <span class="n">enter</span> <span class="n">your</span> <span class="n">orcid</span> <span class="n">ID</span> <span class="k">if</span> <span class="n">you</span> <span class="n">know</span> <span class="n">it</span><span class="p">:</span> <span class="mi">0000</span><span class="o">-</span><span class="mi">0000</span><span class="o">-</span><span class="mi">0000</span><span class="o">-</span><span class="mi">0000</span>
</pre></div>
</div>
<p>After receiving the inputs, the function will write the information to
the <cite>diffpyconfig.json</cite> file in your home directory.</p>
<p><code class="docutils literal notranslate"><span class="pre">check_and_build_global_config()</span></code> returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if the config file exists (whether it created it or not)
and <code class="docutils literal notranslate"><span class="pre">False</span></code> if the config file does not exist in the user’s home allowing you to develop your own
workflow for handling missing config files after running it with <code class="docutils literal notranslate"><span class="pre">skip_config_creation=True</span></code>.</p>
</section>
<section id="i-entered-the-wrong-information-in-my-config-file-so-it-always-loads-incorrect-information-how-do-i-fix-that">
<h3>I entered the wrong information in my config file so it always loads incorrect information, how do I fix that?<a class="headerlink" href="#i-entered-the-wrong-information-in-my-config-file-so-it-always-loads-incorrect-information-how-do-i-fix-that" title="Link to this heading"></a></h3>
<p>It is easy to fix this simply by deleting the global and/or local config files, which will allow
you to re-enter the information during the <code class="docutils literal notranslate"><span class="pre">check_and_build_global_config()</span></code> initialization
workflow.   You can also simply edit the <code class="docutils literal notranslate"><span class="pre">diffpyconfig.json</span></code> file directly using a text
editor.</p>
<p>Locate the file <code class="docutils literal notranslate"><span class="pre">diffpyconfig.json</span></code>, in your home directory and open it in an editor</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;owner_name&quot;</span><span class="p">:</span> <span class="s2">&quot;John Doe&quot;</span><span class="p">,</span>
    <span class="s2">&quot;owner_email&quot;</span><span class="p">:</span> <span class="s2">&quot;john.doe@example.com&quot;</span>
    <span class="s2">&quot;owner_orcid&quot;</span><span class="p">:</span> <span class="s2">&quot;0000-0000-4321-1234&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Then you can edit the username and email as needed, make sure to save your edits.</p>
</section>
</section>
<section id="automatically-capture-info-about-a-software-package-being-used">
<h2>Automatically Capture Info about a Software Package Being Used<a class="headerlink" href="#automatically-capture-info-about-a-software-package-being-used" title="Link to this heading"></a></h2>
<p>We also have a handy tool for capturing information about a python package that is being used
to save in the metadata.  To use this functionality, use he function <code class="docutils literal notranslate"><span class="pre">get_package_info</span></code>, which
inserts or updates software package names and versions in a given metadata dictionary under
the key “package_info”, e.g.,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;package_info&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;diffpy.utils&quot;</span><span class="p">:</span> <span class="s2">&quot;0.3.0&quot;</span><span class="p">,</span> <span class="s2">&quot;my_package&quot;</span><span class="p">:</span> <span class="s2">&quot;0.3.1&quot;</span><span class="p">}}</span>
</pre></div>
</div>
<p>If the installed version of the package “my_package” is 0.3.1.</p>
<p>This function can be used in your code as follows</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">diffpy.utils.tools</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_package_info</span>
<span class="n">package_metadata</span> <span class="o">=</span> <span class="n">get_package_info</span><span class="p">(</span><span class="s2">&quot;my_package&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">package_metadata</span> <span class="o">=</span> <span class="n">get_package_info</span><span class="p">([</span><span class="s2">&quot;first_package&quot;</span><span class="p">,</span> <span class="s2">&quot;second_package&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>which returns (for example)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;package_info&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;diffpy.utils&quot;</span><span class="p">:</span> <span class="s2">&quot;0.3.0&quot;</span><span class="p">,</span> <span class="s2">&quot;first_package&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.1&quot;</span><span class="p">,</span> <span class="s2">&quot;second_package&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0.7&quot;</span><span class="p">}}</span>
</pre></div>
</div>
<p>You can also specify an existing dictionary to be updated with the information.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">existing_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;value&quot;</span><span class="p">}</span>
<span class="n">updated_dict</span> <span class="o">=</span> <span class="n">get_package_info</span><span class="p">(</span><span class="s2">&quot;my_package&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">existing_dict</span><span class="p">))</span>
</pre></div>
</div>
<p>Which returns</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="s2">&quot;package_info&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;diffpy.utils&quot;</span><span class="p">:</span> <span class="s2">&quot;0.3.0&quot;</span><span class="p">,</span> <span class="s2">&quot;my_package&quot;</span><span class="p">:</span> <span class="s2">&quot;0.3.1&quot;</span><span class="p">}}</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">&quot;diffpy.utils&quot;</span></code> is automatically included in the package info since the <code class="docutils literal notranslate"><span class="pre">get_user_info</span></code> function is
part of <code class="docutils literal notranslate"><span class="pre">diffpy.utils</span></code>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="parsers_example.html" class="btn btn-neutral float-left" title="Parsers Example" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="mu_calc_examples.html" class="btn btn-neutral float-right" title="Linear Absorption Coefficient (μ) Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, The Trustees of Columbia University in the City of New York.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>